{"ast":null,"code":"import ENGLISH from './i18n';\nimport RRule from '../index';\nimport { isArray, isNumber, isPresent } from '../helpers'; // =============================================================================\n// Helper functions\n// =============================================================================\n\n/**\n * Return true if a value is in an array\n */\n\nvar contains = function (arr, val) {\n  return arr.indexOf(val) !== -1;\n};\n\nvar defaultGetText = function (id) {\n  return id.toString();\n};\n\nvar defaultDateFormatter = function (year, month, day) {\n  return month + \" \" + day + \", \" + year;\n};\n/**\n *\n * @param {RRule} rrule\n * Optional:\n * @param {Function} gettext function\n * @param {Object} language definition\n * @constructor\n */\n\n\nvar ToText =\n/** @class */\nfunction () {\n  function ToText(rrule, gettext, language, dateFormatter) {\n    if (gettext === void 0) {\n      gettext = defaultGetText;\n    }\n\n    if (language === void 0) {\n      language = ENGLISH;\n    }\n\n    if (dateFormatter === void 0) {\n      dateFormatter = defaultDateFormatter;\n    }\n\n    this.text = [];\n    this.language = language || ENGLISH;\n    this.gettext = gettext;\n    this.dateFormatter = dateFormatter;\n    this.rrule = rrule;\n    this.options = rrule.options;\n    this.origOptions = rrule.origOptions;\n\n    if (this.origOptions.bymonthday) {\n      var bymonthday = [].concat(this.options.bymonthday);\n      var bynmonthday = [].concat(this.options.bynmonthday);\n      bymonthday.sort(function (a, b) {\n        return a - b;\n      });\n      bynmonthday.sort(function (a, b) {\n        return b - a;\n      }); // 1, 2, 3, .., -5, -4, -3, ..\n\n      this.bymonthday = bymonthday.concat(bynmonthday);\n      if (!this.bymonthday.length) this.bymonthday = null;\n    }\n\n    if (isPresent(this.origOptions.byweekday)) {\n      var byweekday = !isArray(this.origOptions.byweekday) ? [this.origOptions.byweekday] : this.origOptions.byweekday;\n      var days = String(byweekday);\n      this.byweekday = {\n        allWeeks: byweekday.filter(function (weekday) {\n          return !weekday.n;\n        }),\n        someWeeks: byweekday.filter(function (weekday) {\n          return Boolean(weekday.n);\n        }),\n        isWeekdays: days.indexOf('MO') !== -1 && days.indexOf('TU') !== -1 && days.indexOf('WE') !== -1 && days.indexOf('TH') !== -1 && days.indexOf('FR') !== -1 && days.indexOf('SA') === -1 && days.indexOf('SU') === -1,\n        isEveryDay: days.indexOf('MO') !== -1 && days.indexOf('TU') !== -1 && days.indexOf('WE') !== -1 && days.indexOf('TH') !== -1 && days.indexOf('FR') !== -1 && days.indexOf('SA') !== -1 && days.indexOf('SU') !== -1\n      };\n\n      var sortWeekDays = function (a, b) {\n        return a.weekday - b.weekday;\n      };\n\n      this.byweekday.allWeeks.sort(sortWeekDays);\n      this.byweekday.someWeeks.sort(sortWeekDays);\n      if (!this.byweekday.allWeeks.length) this.byweekday.allWeeks = null;\n      if (!this.byweekday.someWeeks.length) this.byweekday.someWeeks = null;\n    } else {\n      this.byweekday = null;\n    }\n  }\n  /**\n   * Test whether the rrule can be fully converted to text.\n   * @param {RRule} rrule\n   * @return {Boolean}\n   */\n\n\n  ToText.isFullyConvertible = function (rrule) {\n    var canConvert = true;\n    if (!(rrule.options.freq in ToText.IMPLEMENTED)) return false;\n    if (rrule.origOptions.until && rrule.origOptions.count) return false;\n\n    for (var key in rrule.origOptions) {\n      if (contains(['dtstart', 'wkst', 'freq'], key)) return true;\n      if (!contains(ToText.IMPLEMENTED[rrule.options.freq], key)) return false;\n    }\n\n    return canConvert;\n  };\n\n  ToText.prototype.isFullyConvertible = function () {\n    return ToText.isFullyConvertible(this.rrule);\n  };\n  /**\n   * Perform the conversion. Only some of the frequencies are supported.\n   * If some of the rrule's options aren't supported, they'll\n   * be omitted from the output an \"(~ approximate)\" will be appended.\n   * @return {*}\n   */\n\n\n  ToText.prototype.toString = function () {\n    var gettext = this.gettext;\n\n    if (!(this.options.freq in ToText.IMPLEMENTED)) {\n      return gettext('RRule error: Unable to fully convert this rrule to text');\n    }\n\n    this.text = [gettext('every')]; // @ts-ignore\n\n    this[RRule.FREQUENCIES[this.options.freq]]();\n\n    if (this.options.until) {\n      this.add(gettext('until'));\n      var until = this.options.until;\n      this.add(this.dateFormatter(until.getUTCFullYear(), this.language.monthNames[until.getUTCMonth()], until.getUTCDate()));\n    } else if (this.options.count) {\n      this.add(gettext('for')).add(this.options.count.toString()).add(this.plural(this.options.count) ? gettext('times') : gettext('time'));\n    }\n\n    if (!this.isFullyConvertible()) this.add(gettext('(~ approximate)'));\n    return this.text.join('');\n  };\n\n  ToText.prototype.HOURLY = function () {\n    var gettext = this.gettext;\n    if (this.options.interval !== 1) this.add(this.options.interval.toString());\n    this.add(this.plural(this.options.interval) ? gettext('hours') : gettext('hour'));\n  };\n\n  ToText.prototype.MINUTELY = function () {\n    var gettext = this.gettext;\n    if (this.options.interval !== 1) this.add(this.options.interval.toString());\n    this.add(this.plural(this.options.interval) ? gettext('minutes') : gettext('minute'));\n  };\n\n  ToText.prototype.DAILY = function () {\n    var gettext = this.gettext;\n    if (this.options.interval !== 1) this.add(this.options.interval.toString());\n\n    if (this.byweekday && this.byweekday.isWeekdays) {\n      this.add(this.plural(this.options.interval) ? gettext('weekdays') : gettext('weekday'));\n    } else {\n      this.add(this.plural(this.options.interval) ? gettext('days') : gettext('day'));\n    }\n\n    if (this.origOptions.bymonth) {\n      this.add(gettext('in'));\n\n      this._bymonth();\n    }\n\n    if (this.bymonthday) {\n      this._bymonthday();\n    } else if (this.byweekday) {\n      this._byweekday();\n    } else if (this.origOptions.byhour) {\n      this._byhour();\n    }\n  };\n\n  ToText.prototype.WEEKLY = function () {\n    var gettext = this.gettext;\n\n    if (this.options.interval !== 1) {\n      this.add(this.options.interval.toString()).add(this.plural(this.options.interval) ? gettext('weeks') : gettext('week'));\n    }\n\n    if (this.byweekday && this.byweekday.isWeekdays) {\n      if (this.options.interval === 1) {\n        this.add(this.plural(this.options.interval) ? gettext('weekdays') : gettext('weekday'));\n      } else {\n        this.add(gettext('on')).add(gettext('weekdays'));\n      }\n    } else if (this.byweekday && this.byweekday.isEveryDay) {\n      this.add(this.plural(this.options.interval) ? gettext('days') : gettext('day'));\n    } else {\n      if (this.options.interval === 1) this.add(gettext('week'));\n\n      if (this.origOptions.bymonth) {\n        this.add(gettext('in'));\n\n        this._bymonth();\n      }\n\n      if (this.bymonthday) {\n        this._bymonthday();\n      } else if (this.byweekday) {\n        this._byweekday();\n      }\n    }\n  };\n\n  ToText.prototype.MONTHLY = function () {\n    var gettext = this.gettext;\n\n    if (this.origOptions.bymonth) {\n      if (this.options.interval !== 1) {\n        this.add(this.options.interval.toString()).add(gettext('months'));\n        if (this.plural(this.options.interval)) this.add(gettext('in'));\n      } else {// this.add(gettext('MONTH'))\n      }\n\n      this._bymonth();\n    } else {\n      if (this.options.interval !== 1) this.add(this.options.interval.toString());\n      this.add(this.plural(this.options.interval) ? gettext('months') : gettext('month'));\n    }\n\n    if (this.bymonthday) {\n      this._bymonthday();\n    } else if (this.byweekday && this.byweekday.isWeekdays) {\n      this.add(gettext('on')).add(gettext('weekdays'));\n    } else if (this.byweekday) {\n      this._byweekday();\n    }\n  };\n\n  ToText.prototype.YEARLY = function () {\n    var gettext = this.gettext;\n\n    if (this.origOptions.bymonth) {\n      if (this.options.interval !== 1) {\n        this.add(this.options.interval.toString());\n        this.add(gettext('years'));\n      } else {// this.add(gettext('YEAR'))\n      }\n\n      this._bymonth();\n    } else {\n      if (this.options.interval !== 1) this.add(this.options.interval.toString());\n      this.add(this.plural(this.options.interval) ? gettext('years') : gettext('year'));\n    }\n\n    if (this.bymonthday) {\n      this._bymonthday();\n    } else if (this.byweekday) {\n      this._byweekday();\n    }\n\n    if (this.options.byyearday) {\n      this.add(gettext('on the')).add(this.list(this.options.byyearday, this.nth, gettext('and'))).add(gettext('day'));\n    }\n\n    if (this.options.byweekno) {\n      this.add(gettext('in')).add(this.plural(this.options.byweekno.length) ? gettext('weeks') : gettext('week')).add(this.list(this.options.byweekno, undefined, gettext('and')));\n    }\n  };\n\n  ToText.prototype._bymonthday = function () {\n    var gettext = this.gettext;\n\n    if (this.byweekday && this.byweekday.allWeeks) {\n      this.add(gettext('on')).add(this.list(this.byweekday.allWeeks, this.weekdaytext, gettext('or'))).add(gettext('the')).add(this.list(this.bymonthday, this.nth, gettext('or')));\n    } else {\n      this.add(gettext('on the')).add(this.list(this.bymonthday, this.nth, gettext('and')));\n    } // this.add(gettext('DAY'))\n\n  };\n\n  ToText.prototype._byweekday = function () {\n    var gettext = this.gettext;\n\n    if (this.byweekday.allWeeks && !this.byweekday.isWeekdays) {\n      this.add(gettext('on')).add(this.list(this.byweekday.allWeeks, this.weekdaytext));\n    }\n\n    if (this.byweekday.someWeeks) {\n      if (this.byweekday.allWeeks) this.add(gettext('and'));\n      this.add(gettext('on the')).add(this.list(this.byweekday.someWeeks, this.weekdaytext, gettext('and')));\n    }\n  };\n\n  ToText.prototype._byhour = function () {\n    var gettext = this.gettext;\n    this.add(gettext('at')).add(this.list(this.origOptions.byhour, undefined, gettext('and')));\n  };\n\n  ToText.prototype._bymonth = function () {\n    this.add(this.list(this.options.bymonth, this.monthtext, this.gettext('and')));\n  };\n\n  ToText.prototype.nth = function (n) {\n    n = parseInt(n.toString(), 10);\n    var nth;\n    var npos;\n    var gettext = this.gettext;\n    if (n === -1) return gettext('last');\n    npos = Math.abs(n);\n\n    switch (npos) {\n      case 1:\n      case 21:\n      case 31:\n        nth = npos + gettext('st');\n        break;\n\n      case 2:\n      case 22:\n        nth = npos + gettext('nd');\n        break;\n\n      case 3:\n      case 23:\n        nth = npos + gettext('rd');\n        break;\n\n      default:\n        nth = npos + gettext('th');\n    }\n\n    return n < 0 ? nth + ' ' + gettext('last') : nth;\n  };\n\n  ToText.prototype.monthtext = function (m) {\n    return this.language.monthNames[m - 1];\n  };\n\n  ToText.prototype.weekdaytext = function (wday) {\n    var weekday = isNumber(wday) ? (wday + 1) % 7 : wday.getJsWeekday();\n    return (wday.n ? this.nth(wday.n) + ' ' : '') + this.language.dayNames[weekday];\n  };\n\n  ToText.prototype.plural = function (n) {\n    return n % 100 !== 1;\n  };\n\n  ToText.prototype.add = function (s) {\n    this.text.push(' ');\n    this.text.push(s);\n    return this;\n  };\n\n  ToText.prototype.list = function (arr, callback, finalDelim, delim) {\n    if (delim === void 0) {\n      delim = ',';\n    }\n\n    if (!isArray(arr)) {\n      arr = [arr];\n    }\n\n    var delimJoin = function (array, delimiter, finalDelimiter) {\n      var list = '';\n\n      for (var i = 0; i < array.length; i++) {\n        if (i !== 0) {\n          if (i === array.length - 1) {\n            list += ' ' + finalDelimiter + ' ';\n          } else {\n            list += delimiter + ' ';\n          }\n        }\n\n        list += array[i];\n      }\n\n      return list;\n    };\n\n    callback = callback || function (o) {\n      return o.toString();\n    };\n\n    var self = this;\n\n    var realCallback = function (arg) {\n      return callback && callback.call(self, arg);\n    };\n\n    if (finalDelim) {\n      return delimJoin(arr.map(realCallback), delim, finalDelim);\n    } else {\n      return arr.map(realCallback).join(delim + ' ');\n    }\n  };\n\n  return ToText;\n}();\n\nexport default ToText;","map":{"version":3,"sources":["../../../../src/nlp/totext.ts"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["import ENGLISH from './i18n';\nimport RRule from '../index';\nimport { isArray, isNumber, isPresent } from '../helpers';\n// =============================================================================\n// Helper functions\n// =============================================================================\n/**\n * Return true if a value is in an array\n */\nvar contains = function (arr, val) {\n    return arr.indexOf(val) !== -1;\n};\nvar defaultGetText = function (id) { return id.toString(); };\nvar defaultDateFormatter = function (year, month, day) { return month + \" \" + day + \", \" + year; };\n/**\n *\n * @param {RRule} rrule\n * Optional:\n * @param {Function} gettext function\n * @param {Object} language definition\n * @constructor\n */\nvar ToText = /** @class */ (function () {\n    function ToText(rrule, gettext, language, dateFormatter) {\n        if (gettext === void 0) { gettext = defaultGetText; }\n        if (language === void 0) { language = ENGLISH; }\n        if (dateFormatter === void 0) { dateFormatter = defaultDateFormatter; }\n        this.text = [];\n        this.language = language || ENGLISH;\n        this.gettext = gettext;\n        this.dateFormatter = dateFormatter;\n        this.rrule = rrule;\n        this.options = rrule.options;\n        this.origOptions = rrule.origOptions;\n        if (this.origOptions.bymonthday) {\n            var bymonthday = [].concat(this.options.bymonthday);\n            var bynmonthday = [].concat(this.options.bynmonthday);\n            bymonthday.sort(function (a, b) { return a - b; });\n            bynmonthday.sort(function (a, b) { return b - a; });\n            // 1, 2, 3, .., -5, -4, -3, ..\n            this.bymonthday = bymonthday.concat(bynmonthday);\n            if (!this.bymonthday.length)\n                this.bymonthday = null;\n        }\n        if (isPresent(this.origOptions.byweekday)) {\n            var byweekday = !isArray(this.origOptions.byweekday)\n                ? [this.origOptions.byweekday]\n                : this.origOptions.byweekday;\n            var days = String(byweekday);\n            this.byweekday = {\n                allWeeks: byweekday.filter(function (weekday) {\n                    return !weekday.n;\n                }),\n                someWeeks: byweekday.filter(function (weekday) {\n                    return Boolean(weekday.n);\n                }),\n                isWeekdays: days.indexOf('MO') !== -1 &&\n                    days.indexOf('TU') !== -1 &&\n                    days.indexOf('WE') !== -1 &&\n                    days.indexOf('TH') !== -1 &&\n                    days.indexOf('FR') !== -1 &&\n                    days.indexOf('SA') === -1 &&\n                    days.indexOf('SU') === -1,\n                isEveryDay: days.indexOf('MO') !== -1 &&\n                    days.indexOf('TU') !== -1 &&\n                    days.indexOf('WE') !== -1 &&\n                    days.indexOf('TH') !== -1 &&\n                    days.indexOf('FR') !== -1 &&\n                    days.indexOf('SA') !== -1 &&\n                    days.indexOf('SU') !== -1\n            };\n            var sortWeekDays = function (a, b) {\n                return a.weekday - b.weekday;\n            };\n            this.byweekday.allWeeks.sort(sortWeekDays);\n            this.byweekday.someWeeks.sort(sortWeekDays);\n            if (!this.byweekday.allWeeks.length)\n                this.byweekday.allWeeks = null;\n            if (!this.byweekday.someWeeks.length)\n                this.byweekday.someWeeks = null;\n        }\n        else {\n            this.byweekday = null;\n        }\n    }\n    /**\n     * Test whether the rrule can be fully converted to text.\n     * @param {RRule} rrule\n     * @return {Boolean}\n     */\n    ToText.isFullyConvertible = function (rrule) {\n        var canConvert = true;\n        if (!(rrule.options.freq in ToText.IMPLEMENTED))\n            return false;\n        if (rrule.origOptions.until && rrule.origOptions.count)\n            return false;\n        for (var key in rrule.origOptions) {\n            if (contains(['dtstart', 'wkst', 'freq'], key))\n                return true;\n            if (!contains(ToText.IMPLEMENTED[rrule.options.freq], key))\n                return false;\n        }\n        return canConvert;\n    };\n    ToText.prototype.isFullyConvertible = function () {\n        return ToText.isFullyConvertible(this.rrule);\n    };\n    /**\n     * Perform the conversion. Only some of the frequencies are supported.\n     * If some of the rrule's options aren't supported, they'll\n     * be omitted from the output an \"(~ approximate)\" will be appended.\n     * @return {*}\n     */\n    ToText.prototype.toString = function () {\n        var gettext = this.gettext;\n        if (!(this.options.freq in ToText.IMPLEMENTED)) {\n            return gettext('RRule error: Unable to fully convert this rrule to text');\n        }\n        this.text = [gettext('every')];\n        // @ts-ignore\n        this[RRule.FREQUENCIES[this.options.freq]]();\n        if (this.options.until) {\n            this.add(gettext('until'));\n            var until = this.options.until;\n            this.add(this.dateFormatter(until.getUTCFullYear(), this.language.monthNames[until.getUTCMonth()], until.getUTCDate()));\n        }\n        else if (this.options.count) {\n            this.add(gettext('for'))\n                .add(this.options.count.toString())\n                .add(this.plural(this.options.count) ? gettext('times') : gettext('time'));\n        }\n        if (!this.isFullyConvertible())\n            this.add(gettext('(~ approximate)'));\n        return this.text.join('');\n    };\n    ToText.prototype.HOURLY = function () {\n        var gettext = this.gettext;\n        if (this.options.interval !== 1)\n            this.add(this.options.interval.toString());\n        this.add(this.plural(this.options.interval) ? gettext('hours') : gettext('hour'));\n    };\n    ToText.prototype.MINUTELY = function () {\n        var gettext = this.gettext;\n        if (this.options.interval !== 1)\n            this.add(this.options.interval.toString());\n        this.add(this.plural(this.options.interval)\n            ? gettext('minutes')\n            : gettext('minute'));\n    };\n    ToText.prototype.DAILY = function () {\n        var gettext = this.gettext;\n        if (this.options.interval !== 1)\n            this.add(this.options.interval.toString());\n        if (this.byweekday && this.byweekday.isWeekdays) {\n            this.add(this.plural(this.options.interval)\n                ? gettext('weekdays')\n                : gettext('weekday'));\n        }\n        else {\n            this.add(this.plural(this.options.interval) ? gettext('days') : gettext('day'));\n        }\n        if (this.origOptions.bymonth) {\n            this.add(gettext('in'));\n            this._bymonth();\n        }\n        if (this.bymonthday) {\n            this._bymonthday();\n        }\n        else if (this.byweekday) {\n            this._byweekday();\n        }\n        else if (this.origOptions.byhour) {\n            this._byhour();\n        }\n    };\n    ToText.prototype.WEEKLY = function () {\n        var gettext = this.gettext;\n        if (this.options.interval !== 1) {\n            this.add(this.options.interval.toString()).add(this.plural(this.options.interval) ? gettext('weeks') : gettext('week'));\n        }\n        if (this.byweekday && this.byweekday.isWeekdays) {\n            if (this.options.interval === 1) {\n                this.add(this.plural(this.options.interval)\n                    ? gettext('weekdays')\n                    : gettext('weekday'));\n            }\n            else {\n                this.add(gettext('on')).add(gettext('weekdays'));\n            }\n        }\n        else if (this.byweekday && this.byweekday.isEveryDay) {\n            this.add(this.plural(this.options.interval) ? gettext('days') : gettext('day'));\n        }\n        else {\n            if (this.options.interval === 1)\n                this.add(gettext('week'));\n            if (this.origOptions.bymonth) {\n                this.add(gettext('in'));\n                this._bymonth();\n            }\n            if (this.bymonthday) {\n                this._bymonthday();\n            }\n            else if (this.byweekday) {\n                this._byweekday();\n            }\n        }\n    };\n    ToText.prototype.MONTHLY = function () {\n        var gettext = this.gettext;\n        if (this.origOptions.bymonth) {\n            if (this.options.interval !== 1) {\n                this.add(this.options.interval.toString()).add(gettext('months'));\n                if (this.plural(this.options.interval))\n                    this.add(gettext('in'));\n            }\n            else {\n                // this.add(gettext('MONTH'))\n            }\n            this._bymonth();\n        }\n        else {\n            if (this.options.interval !== 1)\n                this.add(this.options.interval.toString());\n            this.add(this.plural(this.options.interval)\n                ? gettext('months')\n                : gettext('month'));\n        }\n        if (this.bymonthday) {\n            this._bymonthday();\n        }\n        else if (this.byweekday && this.byweekday.isWeekdays) {\n            this.add(gettext('on')).add(gettext('weekdays'));\n        }\n        else if (this.byweekday) {\n            this._byweekday();\n        }\n    };\n    ToText.prototype.YEARLY = function () {\n        var gettext = this.gettext;\n        if (this.origOptions.bymonth) {\n            if (this.options.interval !== 1) {\n                this.add(this.options.interval.toString());\n                this.add(gettext('years'));\n            }\n            else {\n                // this.add(gettext('YEAR'))\n            }\n            this._bymonth();\n        }\n        else {\n            if (this.options.interval !== 1)\n                this.add(this.options.interval.toString());\n            this.add(this.plural(this.options.interval) ? gettext('years') : gettext('year'));\n        }\n        if (this.bymonthday) {\n            this._bymonthday();\n        }\n        else if (this.byweekday) {\n            this._byweekday();\n        }\n        if (this.options.byyearday) {\n            this.add(gettext('on the'))\n                .add(this.list(this.options.byyearday, this.nth, gettext('and')))\n                .add(gettext('day'));\n        }\n        if (this.options.byweekno) {\n            this.add(gettext('in'))\n                .add(this.plural(this.options.byweekno.length)\n                ? gettext('weeks')\n                : gettext('week'))\n                .add(this.list(this.options.byweekno, undefined, gettext('and')));\n        }\n    };\n    ToText.prototype._bymonthday = function () {\n        var gettext = this.gettext;\n        if (this.byweekday && this.byweekday.allWeeks) {\n            this.add(gettext('on'))\n                .add(this.list(this.byweekday.allWeeks, this.weekdaytext, gettext('or')))\n                .add(gettext('the'))\n                .add(this.list(this.bymonthday, this.nth, gettext('or')));\n        }\n        else {\n            this.add(gettext('on the')).add(this.list(this.bymonthday, this.nth, gettext('and')));\n        }\n        // this.add(gettext('DAY'))\n    };\n    ToText.prototype._byweekday = function () {\n        var gettext = this.gettext;\n        if (this.byweekday.allWeeks && !this.byweekday.isWeekdays) {\n            this.add(gettext('on')).add(this.list(this.byweekday.allWeeks, this.weekdaytext));\n        }\n        if (this.byweekday.someWeeks) {\n            if (this.byweekday.allWeeks)\n                this.add(gettext('and'));\n            this.add(gettext('on the')).add(this.list(this.byweekday.someWeeks, this.weekdaytext, gettext('and')));\n        }\n    };\n    ToText.prototype._byhour = function () {\n        var gettext = this.gettext;\n        this.add(gettext('at')).add(this.list(this.origOptions.byhour, undefined, gettext('and')));\n    };\n    ToText.prototype._bymonth = function () {\n        this.add(this.list(this.options.bymonth, this.monthtext, this.gettext('and')));\n    };\n    ToText.prototype.nth = function (n) {\n        n = parseInt(n.toString(), 10);\n        var nth;\n        var npos;\n        var gettext = this.gettext;\n        if (n === -1)\n            return gettext('last');\n        npos = Math.abs(n);\n        switch (npos) {\n            case 1:\n            case 21:\n            case 31:\n                nth = npos + gettext('st');\n                break;\n            case 2:\n            case 22:\n                nth = npos + gettext('nd');\n                break;\n            case 3:\n            case 23:\n                nth = npos + gettext('rd');\n                break;\n            default:\n                nth = npos + gettext('th');\n        }\n        return n < 0 ? nth + ' ' + gettext('last') : nth;\n    };\n    ToText.prototype.monthtext = function (m) {\n        return this.language.monthNames[m - 1];\n    };\n    ToText.prototype.weekdaytext = function (wday) {\n        var weekday = isNumber(wday) ? (wday + 1) % 7 : wday.getJsWeekday();\n        return ((wday.n ? this.nth(wday.n) + ' ' : '') + this.language.dayNames[weekday]);\n    };\n    ToText.prototype.plural = function (n) {\n        return n % 100 !== 1;\n    };\n    ToText.prototype.add = function (s) {\n        this.text.push(' ');\n        this.text.push(s);\n        return this;\n    };\n    ToText.prototype.list = function (arr, callback, finalDelim, delim) {\n        if (delim === void 0) { delim = ','; }\n        if (!isArray(arr)) {\n            arr = [arr];\n        }\n        var delimJoin = function (array, delimiter, finalDelimiter) {\n            var list = '';\n            for (var i = 0; i < array.length; i++) {\n                if (i !== 0) {\n                    if (i === array.length - 1) {\n                        list += ' ' + finalDelimiter + ' ';\n                    }\n                    else {\n                        list += delimiter + ' ';\n                    }\n                }\n                list += array[i];\n            }\n            return list;\n        };\n        callback =\n            callback ||\n                function (o) {\n                    return o.toString();\n                };\n        var self = this;\n        var realCallback = function (arg) {\n            return callback && callback.call(self, arg);\n        };\n        if (finalDelim) {\n            return delimJoin(arr.map(realCallback), delim, finalDelim);\n        }\n        else {\n            return arr.map(realCallback).join(delim + ' ');\n        }\n    };\n    return ToText;\n}());\nexport default ToText;\n//# sourceMappingURL=totext.js.map"]},"metadata":{},"sourceType":"module"}