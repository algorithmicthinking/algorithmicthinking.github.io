{"ast":null,"code":"\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports[\"default\"] = void 0;\n\nvar _extends2 = _interopRequireDefault(require(\"@babel/runtime/helpers/extends\"));\n\nvar _defineProperty2 = _interopRequireDefault(require(\"@babel/runtime/helpers/defineProperty\"));\n\nvar _regenerator = _interopRequireDefault(require(\"@babel/runtime/regenerator\"));\n\nvar _toConsumableArray2 = _interopRequireDefault(require(\"@babel/runtime/helpers/toConsumableArray\"));\n\nvar _asyncToGenerator2 = _interopRequireDefault(require(\"@babel/runtime/helpers/asyncToGenerator\"));\n\nvar _classCallCheck2 = _interopRequireDefault(require(\"@babel/runtime/helpers/classCallCheck\"));\n\nvar _createClass2 = _interopRequireDefault(require(\"@babel/runtime/helpers/createClass\"));\n\nvar _assertThisInitialized2 = _interopRequireDefault(require(\"@babel/runtime/helpers/assertThisInitialized\"));\n\nvar _inherits2 = _interopRequireDefault(require(\"@babel/runtime/helpers/inherits\"));\n\nvar _possibleConstructorReturn2 = _interopRequireDefault(require(\"@babel/runtime/helpers/possibleConstructorReturn\"));\n\nvar _getPrototypeOf2 = _interopRequireDefault(require(\"@babel/runtime/helpers/getPrototypeOf\"));\n\nvar _get2 = _interopRequireDefault(require(\"lodash/get\"));\n\nvar _react = _interopRequireDefault(require(\"react\"));\n\nvar _propTypes = _interopRequireDefault(require(\"prop-types\"));\n\nvar _momentTimezone = _interopRequireDefault(require(\"moment-timezone\"));\n\nvar _rrule = require(\"rrule\");\n\nrequire(\"./index.css\");\n\nvar _event = _interopRequireDefault(require(\"./event\"));\n\nvar _multiEvent = _interopRequireDefault(require(\"./multiEvent\"));\n\nvar _helper = require(\"./utils/helper\");\n\nvar _googleCalendarAPI = require(\"./utils/googleCalendarAPI\");\n\nvar _react2 = require(\"@emotion/react\");\n\nvar _gud = _interopRequireDefault(require(\"gud\"));\n\nfunction ownKeys(object, enumerableOnly) {\n  var keys = Object.keys(object);\n\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n    if (enumerableOnly) symbols = symbols.filter(function (sym) {\n      return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n    });\n    keys.push.apply(keys, symbols);\n  }\n\n  return keys;\n}\n\nfunction _objectSpread(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n\n    if (i % 2) {\n      ownKeys(Object(source), true).forEach(function (key) {\n        (0, _defineProperty2[\"default\"])(target, key, source[key]);\n      });\n    } else if (Object.getOwnPropertyDescriptors) {\n      Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));\n    } else {\n      ownKeys(Object(source)).forEach(function (key) {\n        Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n      });\n    }\n  }\n\n  return target;\n}\n\nfunction _createForOfIteratorHelper(o, allowArrayLike) {\n  var it;\n\n  if (typeof Symbol === \"undefined\" || o[Symbol.iterator] == null) {\n    if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") {\n      if (it) o = it;\n      var i = 0;\n\n      var F = function F() {};\n\n      return {\n        s: F,\n        n: function n() {\n          if (i >= o.length) return {\n            done: true\n          };\n          return {\n            done: false,\n            value: o[i++]\n          };\n        },\n        e: function e(_e) {\n          throw _e;\n        },\n        f: F\n      };\n    }\n\n    throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n  }\n\n  var normalCompletion = true,\n      didErr = false,\n      err;\n  return {\n    s: function s() {\n      it = o[Symbol.iterator]();\n    },\n    n: function n() {\n      var step = it.next();\n      normalCompletion = step.done;\n      return step;\n    },\n    e: function e(_e2) {\n      didErr = true;\n      err = _e2;\n    },\n    f: function f() {\n      try {\n        if (!normalCompletion && it[\"return\"] != null) it[\"return\"]();\n      } finally {\n        if (didErr) throw err;\n      }\n    }\n  };\n}\n\nfunction _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return _arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen);\n}\n\nfunction _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n\n  for (var i = 0, arr2 = new Array(len); i < len; i++) {\n    arr2[i] = arr[i];\n  }\n\n  return arr2;\n}\n\nfunction _createSuper(Derived) {\n  var hasNativeReflectConstruct = _isNativeReflectConstruct();\n\n  return function _createSuperInternal() {\n    var Super = (0, _getPrototypeOf2[\"default\"])(Derived),\n        result;\n\n    if (hasNativeReflectConstruct) {\n      var NewTarget = (0, _getPrototypeOf2[\"default\"])(this).constructor;\n      result = Reflect.construct(Super, arguments, NewTarget);\n    } else {\n      result = Super.apply(this, arguments);\n    }\n\n    return (0, _possibleConstructorReturn2[\"default\"])(this, result);\n  };\n}\n\nfunction _isNativeReflectConstruct() {\n  if (typeof Reflect === \"undefined\" || !Reflect.construct) return false;\n  if (Reflect.construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n\n  try {\n    Date.prototype.toString.call(Reflect.construct(Date, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\nfunction _EMOTION_STRINGIFIED_CSS_ERROR__() {\n  return \"You have tried to stringify object returned from `css` function. It isn't supposed to be used directly (e.g. as value of the `className` prop), but rather handed to emotion so it can handle it (e.g. as value of `css` prop).\";\n}\n\nvar _ref = process.env.NODE_ENV === \"production\" ? {\n  name: \"1hrdiqt\",\n  styles: \"font-size:14px;text-decoration:none;color:inherit;&:hover{text-decoration:underline;}\"\n} : {\n  name: \"d0cexe-Calendar\",\n  styles: \"font-size:14px;text-decoration:none;color:inherit;&:hover{text-decoration:underline;};label:Calendar;\",\n  toString: _EMOTION_STRINGIFIED_CSS_ERROR__\n};\n\nvar _ref2 = process.env.NODE_ENV === \"production\" ? {\n  name: \"p20sj1\",\n  styles: \"vertical-align:top;margin-left:3px;margin-right:3px\"\n} : {\n  name: \"s71wyw-Calendar\",\n  styles: \"vertical-align:top;margin-left:3px;margin-right:3px;label:Calendar;\",\n  toString: _EMOTION_STRINGIFIED_CSS_ERROR__\n};\n\nvar _ref3 = process.env.NODE_ENV === \"production\" ? {\n  name: \"7l8byf\",\n  styles: \"font-size:14px;padding-left:5px;text-align:left\"\n} : {\n  name: \"155wnvz-Calendar\",\n  styles: \"font-size:14px;padding-left:5px;text-align:left;label:Calendar;\",\n  toString: _EMOTION_STRINGIFIED_CSS_ERROR__\n};\n\nvar _ref4 = process.env.NODE_ENV === \"production\" ? {\n  name: \"sgs7ru\",\n  styles: \"padding-right:6px\"\n} : {\n  name: \"csro95-Calendar\",\n  styles: \"padding-right:6px;label:Calendar;\",\n  toString: _EMOTION_STRINGIFIED_CSS_ERROR__\n};\n\nvar _ref5 = process.env.NODE_ENV === \"production\" ? {\n  name: \"sgs7ru\",\n  styles: \"padding-right:6px\"\n} : {\n  name: \"csro95-Calendar\",\n  styles: \"padding-right:6px;label:Calendar;\",\n  toString: _EMOTION_STRINGIFIED_CSS_ERROR__\n};\n\nvar Calendar = /*#__PURE__*/function (_React$Component) {\n  (0, _inherits2[\"default\"])(Calendar, _React$Component);\n\n  var _super = _createSuper(Calendar);\n\n  function Calendar(props) {\n    var _this;\n\n    (0, _classCallCheck2[\"default\"])(this, Calendar);\n    _this = _super.call(this, props);\n    _this.state = {\n      monthNames: [\"January\", \"February\", \"March\", \"April\", \"May\", \"June\", \"July\", \"August\", \"September\", \"October\", \"November\", \"December\"],\n      days: [\"Sun\", \"Mon\", \"Tue\", \"Wed\", \"Thu\", \"Fri\", \"Sat\"],\n      today: (0, _momentTimezone[\"default\"])(),\n      current: (0, _momentTimezone[\"default\"])().startOf(\"month\").utc(true),\n      //current position on calendar (first day of month)\n      calendars: [],\n      events: [],\n      //all day or multi day events\n      singleEvents: [],\n      //single day events\n      userTimezone: _momentTimezone[\"default\"].tz.guess()\n    };\n    _this.lastMonth = _this.lastMonth.bind((0, _assertThisInitialized2[\"default\"])(_this));\n    _this.nextMonth = _this.nextMonth.bind((0, _assertThisInitialized2[\"default\"])(_this));\n    return _this;\n  }\n\n  (0, _createClass2[\"default\"])(Calendar, [{\n    key: \"componentDidMount\",\n    value: function () {\n      var _componentDidMount = (0, _asyncToGenerator2[\"default\"])( /*#__PURE__*/_regenerator[\"default\"].mark(function _callee() {\n        var res, _iterator, _step, calendar, _res, events;\n\n        return _regenerator[\"default\"].wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.prev = 0;\n                _context.next = 3;\n                return (0, _googleCalendarAPI.loadCalendarAPI)(this.props.apiKey);\n\n              case 3:\n                res = _context.sent;\n                console.log(res);\n                _context.next = 10;\n                break;\n\n              case 7:\n                _context.prev = 7;\n                _context.t0 = _context[\"catch\"](0);\n                console.error(\"Error loading GAPI client for API\", _context.t0);\n\n              case 10:\n                //Get events from all calendars\n                _iterator = _createForOfIteratorHelper(this.props.calendars);\n                _context.prev = 11;\n\n                _iterator.s();\n\n              case 13:\n                if ((_step = _iterator.n()).done) {\n                  _context.next = 28;\n                  break;\n                }\n\n                calendar = _step.value;\n                _context.prev = 15;\n                _context.next = 18;\n                return (0, _googleCalendarAPI.getEventsList)(calendar.calendarId);\n\n              case 18:\n                _res = _context.sent; //process events\n\n                events = this.processEvents(_res.result.items, _res.result.summary, calendar.color); //set state with calculated values\n\n                this.setState({\n                  \"events\": [].concat((0, _toConsumableArray2[\"default\"])(this.state.events), (0, _toConsumableArray2[\"default\"])(events[0])),\n                  \"singleEvents\": [].concat((0, _toConsumableArray2[\"default\"])(this.state.singleEvents), (0, _toConsumableArray2[\"default\"])(events[1]))\n                });\n                _context.next = 26;\n                break;\n\n              case 23:\n                _context.prev = 23;\n                _context.t1 = _context[\"catch\"](15);\n                console.error(\"Error getting events\", _context.t1);\n\n              case 26:\n                _context.next = 13;\n                break;\n\n              case 28:\n                _context.next = 33;\n                break;\n\n              case 30:\n                _context.prev = 30;\n                _context.t2 = _context[\"catch\"](11);\n\n                _iterator.e(_context.t2);\n\n              case 33:\n                _context.prev = 33;\n\n                _iterator.f();\n\n                return _context.finish(33);\n\n              case 36:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this, [[0, 7], [11, 30, 33, 36], [15, 23]]);\n      }));\n\n      function componentDidMount() {\n        return _componentDidMount.apply(this, arguments);\n      }\n\n      return componentDidMount;\n    }() //get easy to work with events and singleEvents from response\n\n  }, {\n    key: \"processEvents\",\n    value: function processEvents(items, calendarName, color) {\n      var singleEvents = [];\n      var events = [];\n      var changed = [];\n      var cancelled = [];\n      items.forEach(function (event) {\n        if (event.originalStartTime) {\n          //cancelled or changed events\n          if (event.status == \"cancelled\") {\n            //cancelled events\n            cancelled.push({\n              recurringEventId: event.recurringEventId,\n              originalStartTime: event.originalStartTime.dateTime ? (0, _momentTimezone[\"default\"])(event.originalStartTime.dateTime) : _momentTimezone[\"default\"].parseZone(event.originalStartTime.date)\n            });\n          } else if (event.status == \"confirmed\") {\n            //changed events\n            changed.push({\n              recurringEventId: event.recurringEventId,\n              name: event.summary,\n              description: event.description,\n              location: event.location,\n              originalStartTime: event.originalStartTime.dateTime ? (0, _momentTimezone[\"default\"])(event.originalStartTime.dateTime) : _momentTimezone[\"default\"].parseZone(event.originalStartTime.date),\n              newStartTime: event.start.dateTime ? (0, _momentTimezone[\"default\"])(event.start.dateTime) : _momentTimezone[\"default\"].parseZone(event.start.date),\n              newEndTime: event.end.dateTime ? (0, _momentTimezone[\"default\"])(event.end.dateTime) : _momentTimezone[\"default\"].parseZone(event.end.date)\n            });\n          } else {\n            console.log(\"Not categorized: \", event);\n          }\n        } else if (event.status == \"confirmed\") {\n          //normal events\n          var newEvent = {\n            id: event.id,\n            name: event.summary,\n            startTime: event.start.dateTime ? (0, _momentTimezone[\"default\"])(event.start.dateTime) : _momentTimezone[\"default\"].parseZone(event.start.date),\n            endTime: event.end.dateTime ? (0, _momentTimezone[\"default\"])(event.end.dateTime) : _momentTimezone[\"default\"].parseZone(event.end.date),\n            description: event.description,\n            location: event.location,\n            recurrence: event.recurrence,\n            changedEvents: [],\n            cancelledEvents: [],\n            calendarName: calendarName,\n            color: color\n          };\n\n          if ((0, _helper.isMultiEvent)(newEvent.startTime, newEvent.endTime)) {\n            events.push(newEvent);\n          } else {\n            singleEvents.push(newEvent);\n          }\n        } else {\n          console.log(\"Not categorized: \", event);\n        }\n      }); //add changed events and cancelled events to corresponding event object\n\n      events.forEach(function (event, idx, arr) {\n        if (event.recurrence) {\n          //push changed events\n          changed.filter(function (change) {\n            return change.recurringEventId == event.id;\n          }).forEach(function (change) {\n            arr[idx].changedEvents.push(change);\n          }); //push cancelled events\n\n          cancelled.filter(function (cancel) {\n            return cancel.recurringEventId == event.id;\n          }).forEach(function (cancel) {\n            arr[idx].cancelledEvents.push(cancel.originalStartTime);\n          });\n        }\n      });\n      singleEvents.forEach(function (event, idx, arr) {\n        if (event.recurrence) {\n          //push changed events\n          changed.filter(function (change) {\n            return change.recurringEventId == event.id;\n          }).forEach(function (change) {\n            arr[idx].changedEvents.push(change);\n          }); //push cancelled events\n\n          cancelled.filter(function (cancel) {\n            return cancel.recurringEventId == event.id;\n          }).forEach(function (cancel) {\n            arr[idx].cancelledEvents.push(cancel.originalStartTime);\n          });\n        }\n      });\n      return [events, singleEvents];\n    } //sets current month to previous month\n\n  }, {\n    key: \"lastMonth\",\n    value: function lastMonth() {\n      this.setState({\n        current: this.state.current.subtract(1, \"months\")\n      });\n    } //sets current month to following month\n\n  }, {\n    key: \"nextMonth\",\n    value: function nextMonth() {\n      this.setState({\n        current: this.state.current.add(1, \"months\")\n      });\n    }\n  }, {\n    key: \"clearEvents\",\n    value: function clearEvents() {\n      for (var i = 1; i <= this.state.current.daysInMonth(); i++) {\n        var node = document.getElementById(\"day-\" + i);\n\n        while (node.lastElementChild) {\n          node.removeChild(node.lastElementChild);\n        }\n      }\n    } //renders the day of week names\n\n  }, {\n    key: \"renderDays\",\n    value: function renderDays() {\n      var _this2 = this;\n\n      return this.state.days.map(function (x, i) {\n        return (0, _react2.jsx)(\"div\", {\n          className: \"day-name\",\n          key: \"day-of-week-\" + i,\n          css: [\"border-color:LightGray;\", (0, _get2[\"default\"])(_this2.props.styles, 'day', {}), process.env.NODE_ENV === \"production\" ? \"\" : \";label:Calendar;\"]\n        }, x);\n      });\n    } //renders the blocks for the days of each month\n\n  }, {\n    key: \"renderDates\",\n    value: function renderDates(eventsEachDay) {\n      var _this3 = this;\n\n      var days = (0, _toConsumableArray2[\"default\"])(Array(this.state.current.daysInMonth() + 1).keys()).slice(1); // create array from 1 to number of days in month\n\n      var dayOfWeek = this.state.current.day(); //get day of week of first day in the month\n\n      var padDays = ((-this.state.current.daysInMonth() - this.state.current.day()) % 7 + 7) % 7; //number of days to fill out the last row    \n\n      return [(0, _toConsumableArray2[\"default\"])(Array(dayOfWeek)).map(function (x, i) {\n        return (0, _react2.jsx)(\"div\", {\n          className: \"day\",\n          key: \"empty-day-\" + i,\n          css: (0, _get2[\"default\"])(_this3.props.styles, 'day', {})\n        });\n      }), days.map(function (x) {\n        if (x == _this3.state.today.date() && _this3.state.current.isSame(_this3.state.today, \"month\")) {\n          return (0, _react2.jsx)(\"div\", {\n            className: \"day\",\n            key: \"day-\" + x,\n            css: [(0, _get2[\"default\"])(_this3.props.styles, 'day', {}), (0, _get2[\"default\"])(_this3.props.styles, 'today', {}), process.env.NODE_ENV === \"production\" ? \"\" : \";label:Calendar;\"]\n          }, (0, _react2.jsx)(\"span\", {\n            css: _ref4\n          }, x), (0, _react2.jsx)(\"div\", {\n            className: \"innerDay\",\n            id: \"day-\" + x\n          }, eventsEachDay[x - 1]));\n        } else {\n          return (0, _react2.jsx)(\"div\", {\n            className: \"day\",\n            key: \"day-\" + x,\n            css: (0, _get2[\"default\"])(_this3.props.styles, 'day', {})\n          }, (0, _react2.jsx)(\"span\", {\n            css: _ref5\n          }, x), (0, _react2.jsx)(\"div\", {\n            className: \"innerDay\",\n            id: \"day-\" + x\n          }, eventsEachDay[x - 1]));\n        }\n      }), (0, _toConsumableArray2[\"default\"])(Array(padDays)).map(function (x, i) {\n        return (0, _react2.jsx)(\"div\", {\n          className: \"day\",\n          key: \"empty-day-2-\" + i,\n          css: (0, _get2[\"default\"])(_this3.props.styles, 'day', {})\n        });\n      })];\n    } //get array of arrays of length days in month containing the events in each day\n\n  }, {\n    key: \"getRenderEvents\",\n    value: function getRenderEvents(events, singleEvents) {\n      var _this4 = this;\n\n      var eventsEachDay = (0, _toConsumableArray2[\"default\"])(Array(this.state.current.daysInMonth())).map(function (e) {\n        return [];\n      }); //create array of empty arrays of length daysInMonth\n\n      events.forEach(function (event) {\n        if (event.recurrence) {\n          var duration = _momentTimezone[\"default\"].duration(event.endTime.diff(event.startTime));\n\n          var dates = Calendar.getDatesFromRRule(event.recurrence[0], event.startTime, (0, _momentTimezone[\"default\"])(_this4.state.current).subtract(duration), (0, _momentTimezone[\"default\"])(_this4.state.current).add(1, \"month\")); //render recurrences\n\n          dates.forEach(function (date) {\n            //don't render if it is cancelled\n            if (event.cancelledEvents.some(function (cancelledMoment) {\n              return cancelledMoment.isSame(date, \"day\");\n            })) {\n              return;\n            }\n\n            var props; //update information if event has changed\n\n            var changedEvent = event.changedEvents.find(function (changedEvent) {\n              return changedEvent.originalStartTime.isSame(date, \"day\");\n            });\n\n            if (changedEvent) {\n              props = {\n                name: changedEvent.name,\n                startTime: changedEvent.newStartTime,\n                endTime: changedEvent.newEndTime,\n                description: changedEvent.description,\n                location: changedEvent.location,\n                calendarName: event.calendarName,\n                color: event.color\n              };\n            } else {\n              var eventStart = _momentTimezone[\"default\"].utc(date); //since rrule works with utc times\n\n\n              var eventEnd = (0, _momentTimezone[\"default\"])(eventStart).add(duration);\n              props = {\n                name: event.name,\n                startTime: eventStart,\n                endTime: eventEnd,\n                description: event.description,\n                location: event.location,\n                calendarName: event.calendarName,\n                color: event.color\n              };\n            }\n\n            _this4.drawMultiEvent(eventsEachDay, props);\n          });\n        } else {\n          //render event\n          //check if event is in range\n          if ((event.startTime.month() != _this4.state.current.month() || event.startTime.year() != _this4.state.current.year()) && event.endTime.month() != _this4.state.current.month() || event.endTime.year() != _this4.state.current.year()) {\n            return;\n          }\n\n          _this4.drawMultiEvent(eventsEachDay, event);\n        }\n      });\n      var eventProps = {\n        tooltipStyles: (0, _get2[\"default\"])(this.props.styles, 'tooltip', {}),\n        //gets this.props.styles.tooltip if exists, else empty object\n        eventStyles: (0, _get2[\"default\"])(this.props.styles, 'event', {}),\n        eventCircleStyles: (0, _get2[\"default\"])(this.props.styles, 'eventCircle', {}),\n        eventTextStyles: (0, _get2[\"default\"])(this.props.styles, 'eventText', {})\n      };\n      singleEvents.forEach(function (event) {\n        if (event.recurrence) {\n          var duration = _momentTimezone[\"default\"].duration(event.endTime.diff(event.startTime)); //get recurrences using RRule\n\n\n          var dates = Calendar.getDatesFromRRule(event.recurrence[0], event.startTime, (0, _momentTimezone[\"default\"])(_this4.state.current), (0, _momentTimezone[\"default\"])(_this4.state.current).add(1, \"month\")); //render recurrences\n\n          dates.forEach(function (date) {\n            //check if it is in cancelled\n            if (event.cancelledEvents.some(function (cancelledMoment) {\n              return cancelledMoment.isSame(date, \"day\");\n            })) {\n              return;\n            } //if event has changed\n\n\n            var changedEvent = event.changedEvents.find(function (changedEvent) {\n              return changedEvent.originalStartTime.isSame(date, \"day\");\n            });\n\n            if (changedEvent) {\n              var props = {\n                name: changedEvent.name,\n                startTime: changedEvent.newStartTime,\n                endTime: changedEvent.newEndTime,\n                description: changedEvent.description,\n                location: changedEvent.location,\n                calendarName: event.calendarName,\n                color: event.color\n              };\n            } else {\n              var eventStart = _momentTimezone[\"default\"].utc(date); //avoid bad timezone conversions\n\n\n              var eventEnd = (0, _momentTimezone[\"default\"])(eventStart).add(duration);\n              var props = {\n                name: event.name,\n                startTime: eventStart,\n                endTime: eventEnd,\n                description: event.description,\n                location: event.location,\n                calendarName: event.calendarName,\n                color: event.color\n              };\n            }\n\n            _this4.renderSingleEvent(eventsEachDay, (0, _momentTimezone[\"default\"])(props.startTime).date(), _objectSpread(_objectSpread({}, props), eventProps));\n          });\n        } else {\n          //check if event is in current month\n          if (event.startTime.month() != _this4.state.current.month() || event.startTime.year() != _this4.state.current.year()) {\n            return;\n          }\n\n          _this4.renderSingleEvent(eventsEachDay, (0, _momentTimezone[\"default\"])(event.startTime).date(), _objectSpread(_objectSpread({}, event), eventProps));\n        }\n      });\n      return eventsEachDay;\n    } //TODO: refactor\n    //decides how to render events\n\n  }, {\n    key: \"drawMultiEvent\",\n    value: function drawMultiEvent(eventsEachDay, props) {\n      var startDrawDate;\n      var blockLength = 1;\n      var curDate;\n      var endDate;\n      var arrowLeft = false;\n      var arrowRight = false;\n\n      if (props.endTime.isSame((0, _momentTimezone[\"default\"])(props.endTime).startOf(\"day\"), \"second\")) {\n        endDate = (0, _momentTimezone[\"default\"])(props.endTime).utc(true).subtract(1, \"day\");\n      } else {\n        endDate = (0, _momentTimezone[\"default\"])(props.endTime).utc(true);\n      }\n\n      if ((0, _momentTimezone[\"default\"])(props.startTime).utc(true).isBefore(this.state.current)) {\n        if (this.props.showArrow) {\n          arrowLeft = true;\n        }\n\n        startDrawDate = 1;\n        curDate = (0, _momentTimezone[\"default\"])(this.state.current).utc(true);\n      } else {\n        startDrawDate = props.startTime.date();\n        curDate = (0, _momentTimezone[\"default\"])(props.startTime).utc(true);\n      }\n\n      while (curDate.isSameOrBefore(endDate, \"day\")) {\n        if (curDate.date() == this.state.current.daysInMonth() && !endDate.isSame(this.state.current, 'month')) {\n          if (this.props.showArrow) {\n            arrowRight = true;\n          } //draw then quit\n\n\n          this.renderMultiEventBlock(eventsEachDay, startDrawDate, blockLength, props, arrowLeft, arrowRight);\n          break;\n        }\n\n        if (curDate.date() == this.state.current.daysInMonth() || curDate.isSame(endDate, \"day\")) {\n          //draw then quit\n          this.renderMultiEventBlock(eventsEachDay, startDrawDate, blockLength, props, arrowLeft, arrowRight);\n          break;\n        }\n\n        if (curDate.day() == 6) {\n          //draw then reset\n          this.renderMultiEventBlock(eventsEachDay, startDrawDate, blockLength, props, arrowLeft, arrowRight);\n          startDrawDate = (0, _momentTimezone[\"default\"])(curDate).add(1, \"day\").date();\n          blockLength = 0;\n          arrowLeft = false;\n          arrowRight = false;\n        }\n\n        blockLength++;\n        curDate.add(1, \"day\");\n      }\n    } //TODO: refactor this too?\n    //handles rendering and proper stacking of individual blocks \n\n  }, {\n    key: \"renderMultiEventBlock\",\n    value: function renderMultiEventBlock(eventsEachDay, startDate, length, props, arrowLeft, arrowRight) {\n      var multiEventProps = {\n        tooltipStyles: (0, _get2[\"default\"])(this.props.styles, 'tooltip', {}),\n        //gets this.props.styles.tooltip if exists, else empty object\n        multiEventStyles: (0, _get2[\"default\"])(this.props.styles, 'multiEvent', {})\n      };\n      var maxBlocks = 0;\n      var closedSlots = []; //keep track of rows that the event can't be inserted into\n\n      for (var i = 0; i < length; i++) {\n        var dayEvents = eventsEachDay[startDate - 1 + i];\n\n        if (dayEvents.length > maxBlocks) {\n          maxBlocks = dayEvents.length;\n        } //address rows that are not the last element in closedSlots\n\n\n        for (var j = 0; j < maxBlocks; j++) {\n          if (j > dayEvents.length) {\n            break;\n          } else if (closedSlots.includes(j)) {\n            continue;\n          }\n\n          if (dayEvents[j].props.className.includes(\"isEvent\")) {\n            closedSlots.push(j);\n          }\n        }\n      }\n\n      var chosenRow;\n\n      for (var _i = 0; _i <= maxBlocks; _i++) {\n        if (!closedSlots.includes(_i)) {\n          chosenRow = _i;\n          break;\n        }\n      } //fill in placeholders\n\n\n      for (var _i2 = 0; _i2 < length; _i2++) {\n        //placeholders\n        while (eventsEachDay[startDate - 1 + _i2].length <= chosenRow) {\n          eventsEachDay[startDate - 1 + _i2].push((0, _react2.jsx)(\"div\", {\n            className: \"event below placeholder\",\n            key: \"placeholder-\".concat((0, _gud[\"default\"])())\n          }));\n        } //rest of event that is under the main banner\n\n\n        eventsEachDay[startDate - 1 + _i2][chosenRow] = (0, _react2.jsx)(\"div\", {\n          className: \"isEvent event below\",\n          key: \"filler-\".concat((0, _gud[\"default\"])())\n        });\n      } //render event\n\n\n      eventsEachDay[startDate - 1][chosenRow] = (0, _react2.jsx)(\"div\", {\n        className: \"isEvent\",\n        key: \"multi-event-\".concat(chosenRow)\n      }, (0, _react2.jsx)(_multiEvent[\"default\"], (0, _extends2[\"default\"])({}, props, multiEventProps, {\n        length: length,\n        arrowLeft: arrowLeft,\n        arrowRight: arrowRight,\n        key: \"multi-event-\".concat((0, _gud[\"default\"])())\n      })));\n    } //attempts to render in a placeholder then at the end\n\n  }, {\n    key: \"renderSingleEvent\",\n    value: function renderSingleEvent(eventsEachDay, date, props) {\n      var foundEmpty = false;\n      var nodes = eventsEachDay[date - 1];\n\n      for (var i = 0; i < nodes.length; i++) {\n        if (nodes[i].props.className.includes(\"event\") && !nodes[i].props.className.includes(\"isEvent\")) {\n          //target only placeholders\n          nodes[i] = (0, _react2.jsx)(\"div\", {\n            className: \"isEvent\",\n            key: \"single-event-\".concat((0, _gud[\"default\"])())\n          }, (0, _react2.jsx)(_event[\"default\"], (0, _extends2[\"default\"])({}, props, {\n            key: \"single-event-\".concat((0, _gud[\"default\"])())\n          })));\n          foundEmpty = true;\n          break;\n        }\n      }\n\n      if (!foundEmpty) {\n        eventsEachDay[date - 1].push((0, _react2.jsx)(\"div\", {\n          className: \"isEvent\",\n          key: \"single-event-\".concat((0, _gud[\"default\"])())\n        }, (0, _react2.jsx)(_event[\"default\"], (0, _extends2[\"default\"])({}, props, {\n          key: \"single-event-\".concat((0, _gud[\"default\"])())\n        }))));\n      }\n    } //get dates based on rrule string between dates\n\n  }, {\n    key: \"render\",\n    value: function render() {\n      var eventsEachDay = this.getRenderEvents(this.state.events, this.state.singleEvents);\n      return (0, _react2.jsx)(\"div\", {\n        className: \"calendar\",\n        css: [\"font-size:18px;border:1px solid;min-width:300px;position:relative;border-color:LightGray;color:#51565d;\", (0, _get2[\"default\"])(this.props.styles, 'calendar', {}), process.env.NODE_ENV === \"production\" ? \"\" : \";label:Calendar;\"]\n      }, (0, _react2.jsx)(\"div\", {\n        className: \"calendar-header\"\n      }, (0, _react2.jsx)(\"div\", {\n        className: \"calendar-navigate unselectable\",\n        onClick: this.lastMonth\n      }, \"\\u276E\"), (0, _react2.jsx)(\"div\", null, (0, _react2.jsx)(\"h2\", {\n        className: \"calendar-title\"\n      }, this.state.monthNames[this.state.current.month()] + \" \" + this.state.current.year())), (0, _react2.jsx)(\"div\", {\n        className: \"calendar-navigate unselectable\",\n        onClick: this.nextMonth\n      }, \"\\u276F\")), (0, _react2.jsx)(\"div\", {\n        className: \"calendar-body\"\n      }, this.renderDays(), this.renderDates(eventsEachDay)), (0, _react2.jsx)(\"div\", {\n        className: \"calendar-footer\"\n      }, (0, _react2.jsx)(\"div\", {\n        css: _ref3\n      }, \"All times shown your timezone (\", (0, _momentTimezone[\"default\"])().tz(this.state.userTimezone).format(\"z\"), \")\"), (0, _react2.jsx)(\"div\", {\n        css: _ref2\n      }, (0, _react2.jsx)(\"a\", {\n        href: \"https://calendar.google.com/calendar/r?cid=\" + this.props.calendarId,\n        target: \"_blank\",\n        css: _ref\n      }, \"+ Add Calendar\"))));\n    }\n  }], [{\n    key: \"getDatesFromRRule\",\n    value: function getDatesFromRRule(str, eventStart, betweenStart, betweenEnd) {\n      //get recurrences using RRule\n      var options = _rrule.RRule.parseString(str);\n\n      options.dtstart = (0, _momentTimezone[\"default\"])(eventStart).utc(true).toDate();\n      var rule = new _rrule.RRule(options);\n      var rruleSet = new _rrule.RRuleSet();\n      rruleSet.rrule(rule); //get dates\n\n      var begin = (0, _momentTimezone[\"default\"])(betweenStart).utc(true).toDate();\n      var end = (0, _momentTimezone[\"default\"])(betweenEnd).utc(true).toDate();\n      var dates = rruleSet.between(begin, end);\n      return dates;\n    }\n  }]);\n  return Calendar;\n}(_react[\"default\"].Component);\n\nexports[\"default\"] = Calendar;\nCalendar.propTypes = {\n  calendars: _propTypes[\"default\"].arrayOf(_propTypes[\"default\"].shape({\n    calendarId: _propTypes[\"default\"].string.isRequired,\n    color: _propTypes[\"default\"].string\n  })).isRequired,\n  apiKey: _propTypes[\"default\"].string.isRequired,\n  showArrow: _propTypes[\"default\"].bool,\n  styles: _propTypes[\"default\"].object\n};\nCalendar.defaultProps = {\n  showArrow: true\n};","map":{"version":3,"sources":["/Users/rsha256/cal/algorithmicthinking.github.io/node_modules/@ericz1803/react-google-calendar/index.js"],"names":["_interopRequireDefault","require","Object","defineProperty","exports","value","_extends2","_defineProperty2","_regenerator","_toConsumableArray2","_asyncToGenerator2","_classCallCheck2","_createClass2","_assertThisInitialized2","_inherits2","_possibleConstructorReturn2","_getPrototypeOf2","_get2","_react","_propTypes","_momentTimezone","_rrule","_event","_multiEvent","_helper","_googleCalendarAPI","_react2","_gud","ownKeys","object","enumerableOnly","keys","getOwnPropertySymbols","symbols","filter","sym","getOwnPropertyDescriptor","enumerable","push","apply","_objectSpread","target","i","arguments","length","source","forEach","key","getOwnPropertyDescriptors","defineProperties","_createForOfIteratorHelper","o","allowArrayLike","it","Symbol","iterator","Array","isArray","_unsupportedIterableToArray","F","s","n","done","e","_e","f","TypeError","normalCompletion","didErr","err","step","next","_e2","minLen","_arrayLikeToArray","prototype","toString","call","slice","constructor","name","from","test","arr","len","arr2","_createSuper","Derived","hasNativeReflectConstruct","_isNativeReflectConstruct","_createSuperInternal","Super","result","NewTarget","Reflect","construct","sham","Proxy","Date","_EMOTION_STRINGIFIED_CSS_ERROR__","_ref","process","env","NODE_ENV","styles","_ref2","_ref3","_ref4","_ref5","Calendar","_React$Component","_super","props","_this","state","monthNames","days","today","current","startOf","utc","calendars","events","singleEvents","userTimezone","tz","guess","lastMonth","bind","nextMonth","_componentDidMount","mark","_callee","res","_iterator","_step","calendar","_res","wrap","_callee$","_context","prev","loadCalendarAPI","apiKey","sent","console","log","t0","error","getEventsList","calendarId","processEvents","items","summary","color","setState","concat","t1","t2","finish","stop","componentDidMount","calendarName","changed","cancelled","event","originalStartTime","status","recurringEventId","dateTime","parseZone","date","description","location","newStartTime","start","newEndTime","end","newEvent","id","startTime","endTime","recurrence","changedEvents","cancelledEvents","isMultiEvent","idx","change","cancel","subtract","add","clearEvents","daysInMonth","node","document","getElementById","lastElementChild","removeChild","renderDays","_this2","map","x","jsx","className","css","renderDates","eventsEachDay","_this3","dayOfWeek","day","padDays","isSame","getRenderEvents","_this4","duration","diff","dates","getDatesFromRRule","some","cancelledMoment","changedEvent","find","eventStart","eventEnd","drawMultiEvent","month","year","eventProps","tooltipStyles","eventStyles","eventCircleStyles","eventTextStyles","renderSingleEvent","startDrawDate","blockLength","curDate","endDate","arrowLeft","arrowRight","isBefore","showArrow","isSameOrBefore","renderMultiEventBlock","startDate","multiEventProps","multiEventStyles","maxBlocks","closedSlots","dayEvents","j","includes","chosenRow","_i","_i2","foundEmpty","nodes","render","onClick","format","href","str","betweenStart","betweenEnd","options","RRule","parseString","dtstart","toDate","rule","rruleSet","RRuleSet","rrule","begin","between","Component","propTypes","arrayOf","shape","string","isRequired","bool","defaultProps"],"mappings":"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","sourcesContent":["\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports[\"default\"] = void 0;\n\nvar _extends2 = _interopRequireDefault(require(\"@babel/runtime/helpers/extends\"));\n\nvar _defineProperty2 = _interopRequireDefault(require(\"@babel/runtime/helpers/defineProperty\"));\n\nvar _regenerator = _interopRequireDefault(require(\"@babel/runtime/regenerator\"));\n\nvar _toConsumableArray2 = _interopRequireDefault(require(\"@babel/runtime/helpers/toConsumableArray\"));\n\nvar _asyncToGenerator2 = _interopRequireDefault(require(\"@babel/runtime/helpers/asyncToGenerator\"));\n\nvar _classCallCheck2 = _interopRequireDefault(require(\"@babel/runtime/helpers/classCallCheck\"));\n\nvar _createClass2 = _interopRequireDefault(require(\"@babel/runtime/helpers/createClass\"));\n\nvar _assertThisInitialized2 = _interopRequireDefault(require(\"@babel/runtime/helpers/assertThisInitialized\"));\n\nvar _inherits2 = _interopRequireDefault(require(\"@babel/runtime/helpers/inherits\"));\n\nvar _possibleConstructorReturn2 = _interopRequireDefault(require(\"@babel/runtime/helpers/possibleConstructorReturn\"));\n\nvar _getPrototypeOf2 = _interopRequireDefault(require(\"@babel/runtime/helpers/getPrototypeOf\"));\n\nvar _get2 = _interopRequireDefault(require(\"lodash/get\"));\n\nvar _react = _interopRequireDefault(require(\"react\"));\n\nvar _propTypes = _interopRequireDefault(require(\"prop-types\"));\n\nvar _momentTimezone = _interopRequireDefault(require(\"moment-timezone\"));\n\nvar _rrule = require(\"rrule\");\n\nrequire(\"./index.css\");\n\nvar _event = _interopRequireDefault(require(\"./event\"));\n\nvar _multiEvent = _interopRequireDefault(require(\"./multiEvent\"));\n\nvar _helper = require(\"./utils/helper\");\n\nvar _googleCalendarAPI = require(\"./utils/googleCalendarAPI\");\n\nvar _react2 = require(\"@emotion/react\");\n\nvar _gud = _interopRequireDefault(require(\"gud\"));\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { (0, _defineProperty2[\"default\"])(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _createForOfIteratorHelper(o, allowArrayLike) { var it; if (typeof Symbol === \"undefined\" || o[Symbol.iterator] == null) { if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") { if (it) o = it; var i = 0; var F = function F() {}; return { s: F, n: function n() { if (i >= o.length) return { done: true }; return { done: false, value: o[i++] }; }, e: function e(_e) { throw _e; }, f: F }; } throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); } var normalCompletion = true, didErr = false, err; return { s: function s() { it = o[Symbol.iterator](); }, n: function n() { var step = it.next(); normalCompletion = step.done; return step; }, e: function e(_e2) { didErr = true; err = _e2; }, f: function f() { try { if (!normalCompletion && it[\"return\"] != null) it[\"return\"](); } finally { if (didErr) throw err; } } }; }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = (0, _getPrototypeOf2[\"default\"])(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = (0, _getPrototypeOf2[\"default\"])(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return (0, _possibleConstructorReturn2[\"default\"])(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nfunction _EMOTION_STRINGIFIED_CSS_ERROR__() { return \"You have tried to stringify object returned from `css` function. It isn't supposed to be used directly (e.g. as value of the `className` prop), but rather handed to emotion so it can handle it (e.g. as value of `css` prop).\"; }\n\nvar _ref = process.env.NODE_ENV === \"production\" ? {\n  name: \"1hrdiqt\",\n  styles: \"font-size:14px;text-decoration:none;color:inherit;&:hover{text-decoration:underline;}\"\n} : {\n  name: \"d0cexe-Calendar\",\n  styles: \"font-size:14px;text-decoration:none;color:inherit;&:hover{text-decoration:underline;};label:Calendar;\",\n  toString: _EMOTION_STRINGIFIED_CSS_ERROR__\n};\n\nvar _ref2 = process.env.NODE_ENV === \"production\" ? {\n  name: \"p20sj1\",\n  styles: \"vertical-align:top;margin-left:3px;margin-right:3px\"\n} : {\n  name: \"s71wyw-Calendar\",\n  styles: \"vertical-align:top;margin-left:3px;margin-right:3px;label:Calendar;\",\n  toString: _EMOTION_STRINGIFIED_CSS_ERROR__\n};\n\nvar _ref3 = process.env.NODE_ENV === \"production\" ? {\n  name: \"7l8byf\",\n  styles: \"font-size:14px;padding-left:5px;text-align:left\"\n} : {\n  name: \"155wnvz-Calendar\",\n  styles: \"font-size:14px;padding-left:5px;text-align:left;label:Calendar;\",\n  toString: _EMOTION_STRINGIFIED_CSS_ERROR__\n};\n\nvar _ref4 = process.env.NODE_ENV === \"production\" ? {\n  name: \"sgs7ru\",\n  styles: \"padding-right:6px\"\n} : {\n  name: \"csro95-Calendar\",\n  styles: \"padding-right:6px;label:Calendar;\",\n  toString: _EMOTION_STRINGIFIED_CSS_ERROR__\n};\n\nvar _ref5 = process.env.NODE_ENV === \"production\" ? {\n  name: \"sgs7ru\",\n  styles: \"padding-right:6px\"\n} : {\n  name: \"csro95-Calendar\",\n  styles: \"padding-right:6px;label:Calendar;\",\n  toString: _EMOTION_STRINGIFIED_CSS_ERROR__\n};\n\nvar Calendar = /*#__PURE__*/function (_React$Component) {\n  (0, _inherits2[\"default\"])(Calendar, _React$Component);\n\n  var _super = _createSuper(Calendar);\n\n  function Calendar(props) {\n    var _this;\n\n    (0, _classCallCheck2[\"default\"])(this, Calendar);\n    _this = _super.call(this, props);\n    _this.state = {\n      monthNames: [\"January\", \"February\", \"March\", \"April\", \"May\", \"June\", \"July\", \"August\", \"September\", \"October\", \"November\", \"December\"],\n      days: [\"Sun\", \"Mon\", \"Tue\", \"Wed\", \"Thu\", \"Fri\", \"Sat\"],\n      today: (0, _momentTimezone[\"default\"])(),\n      current: (0, _momentTimezone[\"default\"])().startOf(\"month\").utc(true),\n      //current position on calendar (first day of month)\n      calendars: [],\n      events: [],\n      //all day or multi day events\n      singleEvents: [],\n      //single day events\n      userTimezone: _momentTimezone[\"default\"].tz.guess()\n    };\n    _this.lastMonth = _this.lastMonth.bind((0, _assertThisInitialized2[\"default\"])(_this));\n    _this.nextMonth = _this.nextMonth.bind((0, _assertThisInitialized2[\"default\"])(_this));\n    return _this;\n  }\n\n  (0, _createClass2[\"default\"])(Calendar, [{\n    key: \"componentDidMount\",\n    value: function () {\n      var _componentDidMount = (0, _asyncToGenerator2[\"default\"])( /*#__PURE__*/_regenerator[\"default\"].mark(function _callee() {\n        var res, _iterator, _step, calendar, _res, events;\n\n        return _regenerator[\"default\"].wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.prev = 0;\n                _context.next = 3;\n                return (0, _googleCalendarAPI.loadCalendarAPI)(this.props.apiKey);\n\n              case 3:\n                res = _context.sent;\n                console.log(res);\n                _context.next = 10;\n                break;\n\n              case 7:\n                _context.prev = 7;\n                _context.t0 = _context[\"catch\"](0);\n                console.error(\"Error loading GAPI client for API\", _context.t0);\n\n              case 10:\n                //Get events from all calendars\n                _iterator = _createForOfIteratorHelper(this.props.calendars);\n                _context.prev = 11;\n\n                _iterator.s();\n\n              case 13:\n                if ((_step = _iterator.n()).done) {\n                  _context.next = 28;\n                  break;\n                }\n\n                calendar = _step.value;\n                _context.prev = 15;\n                _context.next = 18;\n                return (0, _googleCalendarAPI.getEventsList)(calendar.calendarId);\n\n              case 18:\n                _res = _context.sent;\n                //process events\n                events = this.processEvents(_res.result.items, _res.result.summary, calendar.color); //set state with calculated values\n\n                this.setState({\n                  \"events\": [].concat((0, _toConsumableArray2[\"default\"])(this.state.events), (0, _toConsumableArray2[\"default\"])(events[0])),\n                  \"singleEvents\": [].concat((0, _toConsumableArray2[\"default\"])(this.state.singleEvents), (0, _toConsumableArray2[\"default\"])(events[1]))\n                });\n                _context.next = 26;\n                break;\n\n              case 23:\n                _context.prev = 23;\n                _context.t1 = _context[\"catch\"](15);\n                console.error(\"Error getting events\", _context.t1);\n\n              case 26:\n                _context.next = 13;\n                break;\n\n              case 28:\n                _context.next = 33;\n                break;\n\n              case 30:\n                _context.prev = 30;\n                _context.t2 = _context[\"catch\"](11);\n\n                _iterator.e(_context.t2);\n\n              case 33:\n                _context.prev = 33;\n\n                _iterator.f();\n\n                return _context.finish(33);\n\n              case 36:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this, [[0, 7], [11, 30, 33, 36], [15, 23]]);\n      }));\n\n      function componentDidMount() {\n        return _componentDidMount.apply(this, arguments);\n      }\n\n      return componentDidMount;\n    }() //get easy to work with events and singleEvents from response\n\n  }, {\n    key: \"processEvents\",\n    value: function processEvents(items, calendarName, color) {\n      var singleEvents = [];\n      var events = [];\n      var changed = [];\n      var cancelled = [];\n      items.forEach(function (event) {\n        if (event.originalStartTime) {\n          //cancelled or changed events\n          if (event.status == \"cancelled\") {\n            //cancelled events\n            cancelled.push({\n              recurringEventId: event.recurringEventId,\n              originalStartTime: event.originalStartTime.dateTime ? (0, _momentTimezone[\"default\"])(event.originalStartTime.dateTime) : _momentTimezone[\"default\"].parseZone(event.originalStartTime.date)\n            });\n          } else if (event.status == \"confirmed\") {\n            //changed events\n            changed.push({\n              recurringEventId: event.recurringEventId,\n              name: event.summary,\n              description: event.description,\n              location: event.location,\n              originalStartTime: event.originalStartTime.dateTime ? (0, _momentTimezone[\"default\"])(event.originalStartTime.dateTime) : _momentTimezone[\"default\"].parseZone(event.originalStartTime.date),\n              newStartTime: event.start.dateTime ? (0, _momentTimezone[\"default\"])(event.start.dateTime) : _momentTimezone[\"default\"].parseZone(event.start.date),\n              newEndTime: event.end.dateTime ? (0, _momentTimezone[\"default\"])(event.end.dateTime) : _momentTimezone[\"default\"].parseZone(event.end.date)\n            });\n          } else {\n            console.log(\"Not categorized: \", event);\n          }\n        } else if (event.status == \"confirmed\") {\n          //normal events\n          var newEvent = {\n            id: event.id,\n            name: event.summary,\n            startTime: event.start.dateTime ? (0, _momentTimezone[\"default\"])(event.start.dateTime) : _momentTimezone[\"default\"].parseZone(event.start.date),\n            endTime: event.end.dateTime ? (0, _momentTimezone[\"default\"])(event.end.dateTime) : _momentTimezone[\"default\"].parseZone(event.end.date),\n            description: event.description,\n            location: event.location,\n            recurrence: event.recurrence,\n            changedEvents: [],\n            cancelledEvents: [],\n            calendarName: calendarName,\n            color: color\n          };\n\n          if ((0, _helper.isMultiEvent)(newEvent.startTime, newEvent.endTime)) {\n            events.push(newEvent);\n          } else {\n            singleEvents.push(newEvent);\n          }\n        } else {\n          console.log(\"Not categorized: \", event);\n        }\n      }); //add changed events and cancelled events to corresponding event object\n\n      events.forEach(function (event, idx, arr) {\n        if (event.recurrence) {\n          //push changed events\n          changed.filter(function (change) {\n            return change.recurringEventId == event.id;\n          }).forEach(function (change) {\n            arr[idx].changedEvents.push(change);\n          }); //push cancelled events\n\n          cancelled.filter(function (cancel) {\n            return cancel.recurringEventId == event.id;\n          }).forEach(function (cancel) {\n            arr[idx].cancelledEvents.push(cancel.originalStartTime);\n          });\n        }\n      });\n      singleEvents.forEach(function (event, idx, arr) {\n        if (event.recurrence) {\n          //push changed events\n          changed.filter(function (change) {\n            return change.recurringEventId == event.id;\n          }).forEach(function (change) {\n            arr[idx].changedEvents.push(change);\n          }); //push cancelled events\n\n          cancelled.filter(function (cancel) {\n            return cancel.recurringEventId == event.id;\n          }).forEach(function (cancel) {\n            arr[idx].cancelledEvents.push(cancel.originalStartTime);\n          });\n        }\n      });\n      return [events, singleEvents];\n    } //sets current month to previous month\n\n  }, {\n    key: \"lastMonth\",\n    value: function lastMonth() {\n      this.setState({\n        current: this.state.current.subtract(1, \"months\")\n      });\n    } //sets current month to following month\n\n  }, {\n    key: \"nextMonth\",\n    value: function nextMonth() {\n      this.setState({\n        current: this.state.current.add(1, \"months\")\n      });\n    }\n  }, {\n    key: \"clearEvents\",\n    value: function clearEvents() {\n      for (var i = 1; i <= this.state.current.daysInMonth(); i++) {\n        var node = document.getElementById(\"day-\" + i);\n\n        while (node.lastElementChild) {\n          node.removeChild(node.lastElementChild);\n        }\n      }\n    } //renders the day of week names\n\n  }, {\n    key: \"renderDays\",\n    value: function renderDays() {\n      var _this2 = this;\n\n      return this.state.days.map(function (x, i) {\n        return (0, _react2.jsx)(\"div\", {\n          className: \"day-name\",\n          key: \"day-of-week-\" + i,\n          css: [\"border-color:LightGray;\", (0, _get2[\"default\"])(_this2.props.styles, 'day', {}), process.env.NODE_ENV === \"production\" ? \"\" : \";label:Calendar;\"]\n        }, x);\n      });\n    } //renders the blocks for the days of each month\n\n  }, {\n    key: \"renderDates\",\n    value: function renderDates(eventsEachDay) {\n      var _this3 = this;\n\n      var days = (0, _toConsumableArray2[\"default\"])(Array(this.state.current.daysInMonth() + 1).keys()).slice(1); // create array from 1 to number of days in month\n\n      var dayOfWeek = this.state.current.day(); //get day of week of first day in the month\n\n      var padDays = ((-this.state.current.daysInMonth() - this.state.current.day()) % 7 + 7) % 7; //number of days to fill out the last row    \n\n      return [(0, _toConsumableArray2[\"default\"])(Array(dayOfWeek)).map(function (x, i) {\n        return (0, _react2.jsx)(\"div\", {\n          className: \"day\",\n          key: \"empty-day-\" + i,\n          css: (0, _get2[\"default\"])(_this3.props.styles, 'day', {})\n        });\n      }), days.map(function (x) {\n        if (x == _this3.state.today.date() && _this3.state.current.isSame(_this3.state.today, \"month\")) {\n          return (0, _react2.jsx)(\"div\", {\n            className: \"day\",\n            key: \"day-\" + x,\n            css: [(0, _get2[\"default\"])(_this3.props.styles, 'day', {}), (0, _get2[\"default\"])(_this3.props.styles, 'today', {}), process.env.NODE_ENV === \"production\" ? \"\" : \";label:Calendar;\"]\n          }, (0, _react2.jsx)(\"span\", {\n            css: _ref4\n          }, x), (0, _react2.jsx)(\"div\", {\n            className: \"innerDay\",\n            id: \"day-\" + x\n          }, eventsEachDay[x - 1]));\n        } else {\n          return (0, _react2.jsx)(\"div\", {\n            className: \"day\",\n            key: \"day-\" + x,\n            css: (0, _get2[\"default\"])(_this3.props.styles, 'day', {})\n          }, (0, _react2.jsx)(\"span\", {\n            css: _ref5\n          }, x), (0, _react2.jsx)(\"div\", {\n            className: \"innerDay\",\n            id: \"day-\" + x\n          }, eventsEachDay[x - 1]));\n        }\n      }), (0, _toConsumableArray2[\"default\"])(Array(padDays)).map(function (x, i) {\n        return (0, _react2.jsx)(\"div\", {\n          className: \"day\",\n          key: \"empty-day-2-\" + i,\n          css: (0, _get2[\"default\"])(_this3.props.styles, 'day', {})\n        });\n      })];\n    } //get array of arrays of length days in month containing the events in each day\n\n  }, {\n    key: \"getRenderEvents\",\n    value: function getRenderEvents(events, singleEvents) {\n      var _this4 = this;\n\n      var eventsEachDay = (0, _toConsumableArray2[\"default\"])(Array(this.state.current.daysInMonth())).map(function (e) {\n        return [];\n      }); //create array of empty arrays of length daysInMonth\n\n      events.forEach(function (event) {\n        if (event.recurrence) {\n          var duration = _momentTimezone[\"default\"].duration(event.endTime.diff(event.startTime));\n\n          var dates = Calendar.getDatesFromRRule(event.recurrence[0], event.startTime, (0, _momentTimezone[\"default\"])(_this4.state.current).subtract(duration), (0, _momentTimezone[\"default\"])(_this4.state.current).add(1, \"month\")); //render recurrences\n\n          dates.forEach(function (date) {\n            //don't render if it is cancelled\n            if (event.cancelledEvents.some(function (cancelledMoment) {\n              return cancelledMoment.isSame(date, \"day\");\n            })) {\n              return;\n            }\n\n            var props; //update information if event has changed\n\n            var changedEvent = event.changedEvents.find(function (changedEvent) {\n              return changedEvent.originalStartTime.isSame(date, \"day\");\n            });\n\n            if (changedEvent) {\n              props = {\n                name: changedEvent.name,\n                startTime: changedEvent.newStartTime,\n                endTime: changedEvent.newEndTime,\n                description: changedEvent.description,\n                location: changedEvent.location,\n                calendarName: event.calendarName,\n                color: event.color\n              };\n            } else {\n              var eventStart = _momentTimezone[\"default\"].utc(date); //since rrule works with utc times\n\n\n              var eventEnd = (0, _momentTimezone[\"default\"])(eventStart).add(duration);\n              props = {\n                name: event.name,\n                startTime: eventStart,\n                endTime: eventEnd,\n                description: event.description,\n                location: event.location,\n                calendarName: event.calendarName,\n                color: event.color\n              };\n            }\n\n            _this4.drawMultiEvent(eventsEachDay, props);\n          });\n        } else {\n          //render event\n          //check if event is in range\n          if ((event.startTime.month() != _this4.state.current.month() || event.startTime.year() != _this4.state.current.year()) && event.endTime.month() != _this4.state.current.month() || event.endTime.year() != _this4.state.current.year()) {\n            return;\n          }\n\n          _this4.drawMultiEvent(eventsEachDay, event);\n        }\n      });\n      var eventProps = {\n        tooltipStyles: (0, _get2[\"default\"])(this.props.styles, 'tooltip', {}),\n        //gets this.props.styles.tooltip if exists, else empty object\n        eventStyles: (0, _get2[\"default\"])(this.props.styles, 'event', {}),\n        eventCircleStyles: (0, _get2[\"default\"])(this.props.styles, 'eventCircle', {}),\n        eventTextStyles: (0, _get2[\"default\"])(this.props.styles, 'eventText', {})\n      };\n      singleEvents.forEach(function (event) {\n        if (event.recurrence) {\n          var duration = _momentTimezone[\"default\"].duration(event.endTime.diff(event.startTime)); //get recurrences using RRule\n\n\n          var dates = Calendar.getDatesFromRRule(event.recurrence[0], event.startTime, (0, _momentTimezone[\"default\"])(_this4.state.current), (0, _momentTimezone[\"default\"])(_this4.state.current).add(1, \"month\")); //render recurrences\n\n          dates.forEach(function (date) {\n            //check if it is in cancelled\n            if (event.cancelledEvents.some(function (cancelledMoment) {\n              return cancelledMoment.isSame(date, \"day\");\n            })) {\n              return;\n            } //if event has changed\n\n\n            var changedEvent = event.changedEvents.find(function (changedEvent) {\n              return changedEvent.originalStartTime.isSame(date, \"day\");\n            });\n\n            if (changedEvent) {\n              var props = {\n                name: changedEvent.name,\n                startTime: changedEvent.newStartTime,\n                endTime: changedEvent.newEndTime,\n                description: changedEvent.description,\n                location: changedEvent.location,\n                calendarName: event.calendarName,\n                color: event.color\n              };\n            } else {\n              var eventStart = _momentTimezone[\"default\"].utc(date); //avoid bad timezone conversions\n\n\n              var eventEnd = (0, _momentTimezone[\"default\"])(eventStart).add(duration);\n              var props = {\n                name: event.name,\n                startTime: eventStart,\n                endTime: eventEnd,\n                description: event.description,\n                location: event.location,\n                calendarName: event.calendarName,\n                color: event.color\n              };\n            }\n\n            _this4.renderSingleEvent(eventsEachDay, (0, _momentTimezone[\"default\"])(props.startTime).date(), _objectSpread(_objectSpread({}, props), eventProps));\n          });\n        } else {\n          //check if event is in current month\n          if (event.startTime.month() != _this4.state.current.month() || event.startTime.year() != _this4.state.current.year()) {\n            return;\n          }\n\n          _this4.renderSingleEvent(eventsEachDay, (0, _momentTimezone[\"default\"])(event.startTime).date(), _objectSpread(_objectSpread({}, event), eventProps));\n        }\n      });\n      return eventsEachDay;\n    } //TODO: refactor\n    //decides how to render events\n\n  }, {\n    key: \"drawMultiEvent\",\n    value: function drawMultiEvent(eventsEachDay, props) {\n      var startDrawDate;\n      var blockLength = 1;\n      var curDate;\n      var endDate;\n      var arrowLeft = false;\n      var arrowRight = false;\n\n      if (props.endTime.isSame((0, _momentTimezone[\"default\"])(props.endTime).startOf(\"day\"), \"second\")) {\n        endDate = (0, _momentTimezone[\"default\"])(props.endTime).utc(true).subtract(1, \"day\");\n      } else {\n        endDate = (0, _momentTimezone[\"default\"])(props.endTime).utc(true);\n      }\n\n      if ((0, _momentTimezone[\"default\"])(props.startTime).utc(true).isBefore(this.state.current)) {\n        if (this.props.showArrow) {\n          arrowLeft = true;\n        }\n\n        startDrawDate = 1;\n        curDate = (0, _momentTimezone[\"default\"])(this.state.current).utc(true);\n      } else {\n        startDrawDate = props.startTime.date();\n        curDate = (0, _momentTimezone[\"default\"])(props.startTime).utc(true);\n      }\n\n      while (curDate.isSameOrBefore(endDate, \"day\")) {\n        if (curDate.date() == this.state.current.daysInMonth() && !endDate.isSame(this.state.current, 'month')) {\n          if (this.props.showArrow) {\n            arrowRight = true;\n          } //draw then quit\n\n\n          this.renderMultiEventBlock(eventsEachDay, startDrawDate, blockLength, props, arrowLeft, arrowRight);\n          break;\n        }\n\n        if (curDate.date() == this.state.current.daysInMonth() || curDate.isSame(endDate, \"day\")) {\n          //draw then quit\n          this.renderMultiEventBlock(eventsEachDay, startDrawDate, blockLength, props, arrowLeft, arrowRight);\n          break;\n        }\n\n        if (curDate.day() == 6) {\n          //draw then reset\n          this.renderMultiEventBlock(eventsEachDay, startDrawDate, blockLength, props, arrowLeft, arrowRight);\n          startDrawDate = (0, _momentTimezone[\"default\"])(curDate).add(1, \"day\").date();\n          blockLength = 0;\n          arrowLeft = false;\n          arrowRight = false;\n        }\n\n        blockLength++;\n        curDate.add(1, \"day\");\n      }\n    } //TODO: refactor this too?\n    //handles rendering and proper stacking of individual blocks \n\n  }, {\n    key: \"renderMultiEventBlock\",\n    value: function renderMultiEventBlock(eventsEachDay, startDate, length, props, arrowLeft, arrowRight) {\n      var multiEventProps = {\n        tooltipStyles: (0, _get2[\"default\"])(this.props.styles, 'tooltip', {}),\n        //gets this.props.styles.tooltip if exists, else empty object\n        multiEventStyles: (0, _get2[\"default\"])(this.props.styles, 'multiEvent', {})\n      };\n      var maxBlocks = 0;\n      var closedSlots = []; //keep track of rows that the event can't be inserted into\n\n      for (var i = 0; i < length; i++) {\n        var dayEvents = eventsEachDay[startDate - 1 + i];\n\n        if (dayEvents.length > maxBlocks) {\n          maxBlocks = dayEvents.length;\n        } //address rows that are not the last element in closedSlots\n\n\n        for (var j = 0; j < maxBlocks; j++) {\n          if (j > dayEvents.length) {\n            break;\n          } else if (closedSlots.includes(j)) {\n            continue;\n          }\n\n          if (dayEvents[j].props.className.includes(\"isEvent\")) {\n            closedSlots.push(j);\n          }\n        }\n      }\n\n      var chosenRow;\n\n      for (var _i = 0; _i <= maxBlocks; _i++) {\n        if (!closedSlots.includes(_i)) {\n          chosenRow = _i;\n          break;\n        }\n      } //fill in placeholders\n\n\n      for (var _i2 = 0; _i2 < length; _i2++) {\n        //placeholders\n        while (eventsEachDay[startDate - 1 + _i2].length <= chosenRow) {\n          eventsEachDay[startDate - 1 + _i2].push((0, _react2.jsx)(\"div\", {\n            className: \"event below placeholder\",\n            key: \"placeholder-\".concat((0, _gud[\"default\"])())\n          }));\n        } //rest of event that is under the main banner\n\n\n        eventsEachDay[startDate - 1 + _i2][chosenRow] = (0, _react2.jsx)(\"div\", {\n          className: \"isEvent event below\",\n          key: \"filler-\".concat((0, _gud[\"default\"])())\n        });\n      } //render event\n\n\n      eventsEachDay[startDate - 1][chosenRow] = (0, _react2.jsx)(\"div\", {\n        className: \"isEvent\",\n        key: \"multi-event-\".concat(chosenRow)\n      }, (0, _react2.jsx)(_multiEvent[\"default\"], (0, _extends2[\"default\"])({}, props, multiEventProps, {\n        length: length,\n        arrowLeft: arrowLeft,\n        arrowRight: arrowRight,\n        key: \"multi-event-\".concat((0, _gud[\"default\"])())\n      })));\n    } //attempts to render in a placeholder then at the end\n\n  }, {\n    key: \"renderSingleEvent\",\n    value: function renderSingleEvent(eventsEachDay, date, props) {\n      var foundEmpty = false;\n      var nodes = eventsEachDay[date - 1];\n\n      for (var i = 0; i < nodes.length; i++) {\n        if (nodes[i].props.className.includes(\"event\") && !nodes[i].props.className.includes(\"isEvent\")) {\n          //target only placeholders\n          nodes[i] = (0, _react2.jsx)(\"div\", {\n            className: \"isEvent\",\n            key: \"single-event-\".concat((0, _gud[\"default\"])())\n          }, (0, _react2.jsx)(_event[\"default\"], (0, _extends2[\"default\"])({}, props, {\n            key: \"single-event-\".concat((0, _gud[\"default\"])())\n          })));\n          foundEmpty = true;\n          break;\n        }\n      }\n\n      if (!foundEmpty) {\n        eventsEachDay[date - 1].push((0, _react2.jsx)(\"div\", {\n          className: \"isEvent\",\n          key: \"single-event-\".concat((0, _gud[\"default\"])())\n        }, (0, _react2.jsx)(_event[\"default\"], (0, _extends2[\"default\"])({}, props, {\n          key: \"single-event-\".concat((0, _gud[\"default\"])())\n        }))));\n      }\n    } //get dates based on rrule string between dates\n\n  }, {\n    key: \"render\",\n    value: function render() {\n      var eventsEachDay = this.getRenderEvents(this.state.events, this.state.singleEvents);\n      return (0, _react2.jsx)(\"div\", {\n        className: \"calendar\",\n        css: [\"font-size:18px;border:1px solid;min-width:300px;position:relative;border-color:LightGray;color:#51565d;\", (0, _get2[\"default\"])(this.props.styles, 'calendar', {}), process.env.NODE_ENV === \"production\" ? \"\" : \";label:Calendar;\"]\n      }, (0, _react2.jsx)(\"div\", {\n        className: \"calendar-header\"\n      }, (0, _react2.jsx)(\"div\", {\n        className: \"calendar-navigate unselectable\",\n        onClick: this.lastMonth\n      }, \"\\u276E\"), (0, _react2.jsx)(\"div\", null, (0, _react2.jsx)(\"h2\", {\n        className: \"calendar-title\"\n      }, this.state.monthNames[this.state.current.month()] + \" \" + this.state.current.year())), (0, _react2.jsx)(\"div\", {\n        className: \"calendar-navigate unselectable\",\n        onClick: this.nextMonth\n      }, \"\\u276F\")), (0, _react2.jsx)(\"div\", {\n        className: \"calendar-body\"\n      }, this.renderDays(), this.renderDates(eventsEachDay)), (0, _react2.jsx)(\"div\", {\n        className: \"calendar-footer\"\n      }, (0, _react2.jsx)(\"div\", {\n        css: _ref3\n      }, \"All times shown your timezone (\", (0, _momentTimezone[\"default\"])().tz(this.state.userTimezone).format(\"z\"), \")\"), (0, _react2.jsx)(\"div\", {\n        css: _ref2\n      }, (0, _react2.jsx)(\"a\", {\n        href: \"https://calendar.google.com/calendar/r?cid=\" + this.props.calendarId,\n        target: \"_blank\",\n        css: _ref\n      }, \"+ Add Calendar\"))));\n    }\n  }], [{\n    key: \"getDatesFromRRule\",\n    value: function getDatesFromRRule(str, eventStart, betweenStart, betweenEnd) {\n      //get recurrences using RRule\n      var options = _rrule.RRule.parseString(str);\n\n      options.dtstart = (0, _momentTimezone[\"default\"])(eventStart).utc(true).toDate();\n      var rule = new _rrule.RRule(options);\n      var rruleSet = new _rrule.RRuleSet();\n      rruleSet.rrule(rule); //get dates\n\n      var begin = (0, _momentTimezone[\"default\"])(betweenStart).utc(true).toDate();\n      var end = (0, _momentTimezone[\"default\"])(betweenEnd).utc(true).toDate();\n      var dates = rruleSet.between(begin, end);\n      return dates;\n    }\n  }]);\n  return Calendar;\n}(_react[\"default\"].Component);\n\nexports[\"default\"] = Calendar;\nCalendar.propTypes = {\n  calendars: _propTypes[\"default\"].arrayOf(_propTypes[\"default\"].shape({\n    calendarId: _propTypes[\"default\"].string.isRequired,\n    color: _propTypes[\"default\"].string\n  })).isRequired,\n  apiKey: _propTypes[\"default\"].string.isRequired,\n  showArrow: _propTypes[\"default\"].bool,\n  styles: _propTypes[\"default\"].object\n};\nCalendar.defaultProps = {\n  showArrow: true\n};"]},"metadata":{},"sourceType":"script"}